(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{25:function(e,t,n){},37:function(e,t,n){},45:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),c=n(29),s=n.n(c),i=(n(37),n(10)),o=n(11),u=n(12),l=n(13),j=(n(25),n(9)),h=n(48),d=n(49),p=n(50),b=n(51),m=n(18),O=n(1),f=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={isOpen:!1},r.toggle=r.toggle.bind(Object(j.a)(r)),r}return Object(o.a)(n,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"render",value:function(){return Object(O.jsxs)(h.a,{color:"dark",dark:!0,expand:"md",children:[Object(O.jsx)(d.a,{}),Object(O.jsx)(d.a,{tag:m.b,to:"/EmptyQueue",children:"EmptyQueue"}),Object(O.jsx)(p.a,{className:"ms-auto",children:Object(O.jsx)(b.a,{href:"/EmptyQueue/perform_login",children:"Login (\u044d\u0442\u0430 \u043a\u043d\u043e\u043f\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0432 pages)"})})]})}}]),n}(r.Component),x=n(52),g=n(53),v=n.p+"static/media/queue.8f7e5006.png",y=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this;return Object(O.jsxs)("div",{children:[Object(O.jsx)(f,{}),Object(O.jsxs)(x.a,{fluid:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[Object(O.jsx)("img",{src:v,alt:""}),Object(O.jsx)("h3",{children:"EmptyQueue - service for building queues."}),Object(O.jsx)(g.a,{onClick:function(){e.props.history.push("/EmptyQueue/queue")},children:"Get started"}),Object(O.jsx)(g.a,{onClick:function(){e.props.history.push("/EmptyQueue/perform_login")},children:"Login (\u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0437\u0434\u0435\u0441\u044c \u044f \u043d\u0430\u0440\u0438\u0441\u043e\u0432\u0430\u043b \u0442\u0430\u043a\u0443\u044e)"})]})]})}}]),n}(r.Component),w=y,C=n(7),k=n(27),S=n(19),E=n(17),N=n.n(E),Q=n(54),q=n(55),I=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={queues:[{participants:["\u0416\u043e\u0440\u0430","\u0414\u0438\u043c\u0430","\u0421\u0442\u0430\u0441\u044f\u043d"],name:"\u041a\u0442\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0438\u0434\u0435\u0442 \u0437\u0430 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u043e\u0439",owner:"master",current:0,id:0}]},r.remove=r.remove.bind(Object(j.a)(r)),r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){}},{key:"remove",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n=this;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/queue/".concat(t),{method:"DELETE"}).then((function(){var e=Object(k.a)(n.state.queues).filter((function(e){return e.id!==t}));n.setState({queues:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"iterate",value:function(){var e=Object(S.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(k.a)(this.state.queues).map((function(e,n){return console.log(n+" "+t),n===t&&(e.current=(e.current+1)%e.participants.length),e})),this.setState({queues:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.queues.map((function(t){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{style:{whiteSpace:"nowrap"},children:t.name}),Object(O.jsx)("td",{children:t.participants[t.current]}),Object(O.jsxs)("td",{children:[" ",t.participants.map((function(e,t){return Object(O.jsxs)("div",{children:[e,Object(O.jsx)("br",{})]},t)}))]}),Object(O.jsx)("td",{children:Object(O.jsxs)(Q.a,{children:[Object(O.jsx)(g.a,{size:"sm",color:"primary",onClick:function(){return e.iterate(t.id)},children:"Iterate"}),Object(O.jsx)(g.a,{size:"sm",color:"secondary",tag:m.b,to:"/EmptyQueue/queue/new"+t.id,children:"Edit"}),Object(O.jsx)(g.a,{size:"sm",color:"danger",onClick:function(){return e.remove(t.id)},children:"Delete"})]})})]},t.id)}));return Object(O.jsxs)("div",{children:[Object(O.jsx)(f,{}),Object(O.jsxs)(x.a,{fluid:!0,children:[Object(O.jsx)("div",{className:"float-right",children:Object(O.jsx)(g.a,{color:"success",tag:m.b,to:"/EmptyQueue/queue/new",children:"Add Queue"})}),Object(O.jsx)("h3",{children:"Queues"}),Object(O.jsxs)(q.a,{className:"mt-4",children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{width:"30%",children:"Name"}),Object(O.jsx)("th",{width:"30%",children:"Next"}),Object(O.jsx)("th",{width:"30%",children:"Participants"}),Object(O.jsx)("th",{width:"40%",children:"Actions"})]})}),Object(O.jsx)("tbody",{children:t})]})]})]})}}]),n}(r.Component),L=I,D=n(14),P=n(56),F=n(57),T=n(58),_=n(59),z=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).emptyItem={name:"",participants:["",""]},r.state={item:r.emptyItem},r.handleChange=r.handleChange.bind(Object(j.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(j.a)(r)),r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=Object(S.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("new"===this.props.match.params.id){e.next=7;break}return e.next=3,fetch("/queue/".concat(this.props.match.params.id));case 3:return e.next=5,e.sent.json();case 5:t=e.sent,this.setState({item:t});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){var t=e.target,n=t.value,r=t.name,a=Object(D.a)({},this.state.item);"name"===r?a[r]=n:a.participants[r]=n,this.setState({item:a})}},{key:"handleSubmit",value:function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),this.state.item,this.props.history.push("/EmptyQueue/queue");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.item,n=Object(O.jsx)("h2",{children:t.id?"Edit Queue":"Add Queue"});return Object(O.jsxs)("div",{children:[Object(O.jsx)(f,{}),Object(O.jsxs)(x.a,{children:[n,Object(O.jsxs)(T.a,{onSubmit:this.handleSubmit,children:[Object(O.jsxs)(P.a,{className:"mb-3",children:[Object(O.jsx)(_.a,{for:"name",children:"Name"}),Object(O.jsx)(F.a,{type:"text",name:"name",id:"name",value:t.name||"",onChange:this.handleChange,autoComplete:"name"})]}),Object(O.jsxs)(P.a,{className:"mb-3",children:[Object(O.jsx)(_.a,{for:"participants",children:"Participants"}),"  ",Object(O.jsx)(g.a,{color:"primary",onClick:function(){t.participants.push(""),e.setState({item:t})},children:" Add"}),"  ",Object(O.jsx)(g.a,{color:"success",onClick:function(){t.participants.sort((function(){return.5-Math.random()})),e.setState({item:t})},children:"Shuffle"})]}),t.participants.map((function(n,r){return function(n,r){return Object(O.jsxs)(P.a,{className:"input-group mb-3",children:[Object(O.jsx)("div",{className:"input-group-prepend",children:Object(O.jsxs)("span",{className:"input-group-text",id:"inputGroup-sizing-sm",children:["#",r+1]})}),Object(O.jsx)(F.a,{type:"text",name:r,id:r,value:n,autoComplete:n,onChange:e.handleChange,style:{width:"50%"}}),Object(O.jsx)(g.a,{color:"primary",onClick:function(){r>0&&(t.participants[r]=t.participants[r-1],t.participants[r-1]=n),e.setState({item:t})},children:" Up"}),Object(O.jsx)(g.a,{color:"secondary",onClick:function(){r!==t.participants.length-1&&(t.participants[r]=t.participants[r+1],t.participants[r+1]=n),e.setState({item:t})},children:" Down"}),Object(O.jsx)(g.a,{color:"danger",onClick:function(){t.participants.length>2&&e.state.item.participants.splice(r,1),e.setState({item:t})},children:" Remove"})]},r)}(n,r)})),Object(O.jsxs)(P.a,{className:"mb-3",children:[Object(O.jsx)(g.a,{color:"primary",type:"submit",children:"Save"})," ",Object(O.jsx)(g.a,{color:"secondary",tag:m.b,to:"/EmptyQueue/queue",children:"Cancel"})]})]})]})]})}}]),n}(r.Component),A=Object(C.g)(z),R=n(20),M=n(32),U=(n(45),a.a.createContext({isLoggedIn:!0,change:function(){}})),G=["handleError"];window.getCsrfToken=function(){return document.cookie.replace(/(?:(?:^|.*;\s*)XSRF-TOKEN\s*\s*([^;]*).*$)|^.*$/,"$1")};var X=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).inputChange=function(e){var t=e.target.value;r.setState({value:t})},r.state={value:e.value?e.value:"",className:e.className?e.className:"",error:!1},r}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.handleError,n=Object(M.a)(e,G);return this.handleError=t,Object(O.jsx)("input",Object(D.a)(Object(D.a)({},n),{},{value:this.state.value,onChange:this.inputChange,className:this.state.className}))}}]),n}(r.Component),$=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).handleSubmit=function(e){if(e.preventDefault(),!r.state.errcount){var t=new FormData(r.form);fetch(r.form.action,{method:r.form.method,body:new URLSearchParams(t),headers:{"X-XSRF-TOKEN":window.getCsrfToken()}}).then((function(e){e.redirected&&(window.location=e.url),r.change(!0)})).catch((function(e){r.setState({failure:"wrong username or password!",errcount:0})}))}},r.handleError=function(e,t){e&&(t?r.setState((function(n){return{failure:"",errcount:n.errcount+1,errmsgs:Object(D.a)(Object(D.a)({},n.errmsgs),{},Object(R.a)({},e,t))}})):r.setState((function(t){return{failure:"",errcount:1===t.errcount?0:t.errcount-1,errmsgs:Object(D.a)(Object(D.a)({},t.errmsgs),{},Object(R.a)({},e,""))}})))},r.renderError=function(){if(r.state.errcount||r.state.failure){var e=r.state.failure||Object.values(r.state.errmsgs).find((function(e){return e}));return console.log("error: ".concat(e)),Object(O.jsx)("div",{className:"error",children:e})}},r.change=e.changer,r.childProps=Object(D.a)({},r.props),delete r.childProps.changer,e.error?r.state={failure:"wrong username or password!",errcount:0}:r.state={errcount:0},r}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props.inputs.map((function(t,n){var r=t.name,a=t.placeholder,c=t.type,s=t.value,i=t.className;return Object(O.jsx)(P.a,{className:"mb-3",children:i?Object(O.jsx)(g.a,{name:r,placeholder:a,type:c,value:s,color:"success",className:"btn",children:"Submit"},n):Object(O.jsx)(X,{size:"lg",name:r,placeholder:a,type:c,value:s,handleError:e.handleError},n)},n)})),n=this.renderError();return Object(O.jsxs)("div",{className:"Login",children:[Object(O.jsx)("h1",{children:"Welcome!"}),Object(O.jsxs)("form",Object(D.a)(Object(D.a)({},this.childProps),{},{onSubmit:this.handleSubmit,ref:function(t){e.form=t},children:[t,n]}))]})}}]),n}(r.Component),B=[{name:"username",placeholder:"username",type:"text"},{name:"password",placeholder:"password",type:"password"},{type:"submit",value:"Submit",className:"btn"}],J=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e={name:"loginForm",method:"POST",action:"/perform_login",inputs:B},t=new URLSearchParams(window.location.search);return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(f,{}),Object(O.jsx)(U.Consumer,{children:function(n){var r=n.change;return Object(O.jsx)($,Object(D.a)(Object(D.a)({},e),{},{error:t.get("error"),changer:r}))}})]})}}]),n}(r.Component),K=J,H=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;Object(i.a)(this,n),(r=t.call(this,e)).change=function(e){r.setState((function(t){return{isLoggedIn:e}})),console.log("CHANGE!!!"),console.log(r.state.isLoggedIn),fetch("/check_login").then((function(e){return e.json()})).then((function(e){console.log("fetched "+e.success)}))};var a="true"===localStorage.getItem("isLoggedIn");return r.state={isLoggedIn:a,change:r.change},r}return Object(o.a)(n,[{key:"componentDidUpdate",value:function(e,t){this.state.isLoggedIn!==t.isLoggedIn&&localStorage.setItem("isLoggedIn",this.state.isLoggedIn)}},{key:"render",value:function(){return Object(O.jsx)(U.Provider,{value:this.state,children:Object(O.jsx)(m.a,{children:Object(O.jsxs)(C.d,{children:[Object(O.jsx)(C.b,{path:"/EmptyQueue/queue",exact:!0,render:function(){return Object(O.jsx)(L,{})}}),Object(O.jsx)(C.b,{path:"/",exact:!0,component:w}),Object(O.jsx)(C.b,{path:"/EmptyQueue/",exact:!0,component:w}),Object(O.jsx)(C.b,{path:"/EmptyQueue/queue/:id",render:function(){return Object(O.jsx)(A,{})}}),Object(O.jsx)(C.b,{path:"/EmptyQueue/perform_login",component:K}),Object(O.jsx)(C.b,{path:"/perform_logout",render:function(){return Object(O.jsx)(C.a,{to:"/"})}})]})})})}}]),n}(r.Component),W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,60)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};n(46);s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(H,{})}),document.getElementById("root")),W()}},[[47,1,2]]]);
//# sourceMappingURL=main.438b9568.chunk.js.map